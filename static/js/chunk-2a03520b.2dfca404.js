(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2a03520b"],{"0a09":function(e,t,a){"use strict";a("6843")},6843:function(e,t,a){},a9e2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"用户名搜索",clearable:""},on:{clear:e.getArticlePage},model:{value:e.queryInfo.nickname,callback:function(t){e.$set(e.queryInfo,"nickname",t)},expression:"queryInfo.nickname"}})],1),a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"标题搜索",clearable:""},on:{clear:e.getArticlePage},model:{value:e.queryInfo.title,callback:function(t){e.$set(e.queryInfo,"title",t)},expression:"queryInfo.title"}})],1),a("el-col",{attrs:{span:3}},[a("el-cascader",{attrs:{placeholder:"分类搜索",options:e.options,props:e.props,"collapse-tags":"",clearable:"","show-all-levels":!1},on:{clear:e.getArticlePage},model:{value:e.queryInfo.categoryIds,callback:function(t){e.$set(e.queryInfo,"categoryIds",t)},expression:"queryInfo.categoryIds"}})],1),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"状态搜索",clearable:""},on:{clear:e.getArticlePage},model:{value:e.queryInfo.state,callback:function(t){e.$set(e.queryInfo,"state",t)},expression:"queryInfo.state"}},e._l(e.states,(function(e){return a("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})})),1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:e.getArticlePage}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.aticleList,border:""}},[a("el-table-column",{attrs:{align:"center",label:"编号",type:"index",index:e.tableIndex,width:"55px"}}),a("el-table-column",{attrs:{align:"center",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.fileTypes[t.row.type-1].display_name)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.categoryTitle)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"标题",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.title)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"收藏数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.collectNum)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"点赞数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.praiseNum)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"评论数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.commentNum)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.states[t.row.state+1].display_name)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.row.state,expression:"scope.row.state == 1"}],attrs:{type:"warning",size:"small"},on:{click:function(a){return e.handleEditState(t)}}},[e._v("屏蔽")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:3==t.row.state,expression:"scope.row.state == 3"}],attrs:{type:"info",size:"small"},on:{click:function(a){return e.handleEditState(t)}}},[e._v("取消屏蔽")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=t.row.state,expression:"scope.row.state != -1"}],attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleDetails(t)}}},[e._v(" "+e._s(e.$t("common.details"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1==t.row.state,expression:"scope.row.state == -1"}],attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleEdit(t)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDelete(t)}}},[e._v(" "+e._s(e.$t("common.delete"))+" ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.queryInfo.page,"page-sizes":[10,20,50,100],"page-size":e.queryInfo.size,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{visible:e.detailsVisible,top:"10vh"},on:{"update:visible":function(t){e.detailsVisible=t},close:e.closeDetailsModal}},[1==e.detailsfileType?a("div",{staticClass:"video-modal-content"},[a("NPlayer",{ref:"player",attrs:{options:{src:e.previewVideoUrl,contextMenus:["loop","pip"],volumeVertical:!0,volumeProgressBg:"skyblue"},set:e.setPlayer}})],1):e._e()]),a("el-dialog",{attrs:{visible:e.editVisible,top:"10vh"},on:{"update:visible":function(t){e.editVisible=t}}},[a(e.currentComponent,{key:e.dataProp,tag:"component",attrs:{dataProp:e.dataProp},on:{notifyParent:e.refreshArticlePage}})],1)],1)},l=[],r=a("2909"),s=a("c7eb"),i=a("1da1"),o=(a("99af"),a("75cc")),c=a("f974"),u=a("71c3"),p=a("d9f5"),d=a("4a0d"),f={name:"Article",components:{articleVideo:u["a"],articleColumn:p["a"],articleAudio:d["a"]},data:function(){return{loading:!1,aticleList:[],pageInfo:{page:1,size:10,total:0,pages:0},queryInfo:{nickname:null,categoryIds:null,title:null,state:null,page:1,size:10},state:"",props:{multiple:!0,value:"id",label:"title"},categoryList:{title:null,parents:!1},options:[],fileTypes:[{key:"1",display_name:"视频"},{key:"2",display_name:"专栏"},{key:"3",display_name:"音频"}],states:[{key:"-1",display_name:"草稿"},{key:"0",display_name:"待审核"},{key:"1",display_name:"审核通过"},{key:"2",display_name:"审核未通过"},{key:"3",display_name:"屏蔽"}],detailsVisible:!1,detailsfileType:null,previewVideoUrl:null,player:null,editVisible:!1,currentComponent:null,dataProp:null}},created:function(){this.getCategoryList(),this.getArticlePage()},methods:{getCategoryList:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["b"])(e.categoryList);case 2:a=t.sent,e.options=a.data;case 4:case"end":return t.stop()}}),t)})))()},getCategoryIdList:function(){if(null!=this.queryInfo.categoryIds&&this.queryInfo.categoryIds.length>0){var e,t=(e=[]).concat.apply(e,Object(r["a"])(this.queryInfo.categoryIds));this.queryInfo.categoryIds=t}},getArticlePage:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var a;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.getCategoryIdList(),t.next=4,Object(c["d"])(e.queryInfo);case 4:a=t.sent,e.aticleList=a.data.list,e.pageInfo=a.data.pageInfo,e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.queryInfo.size=e,this.getArticlePage()},handleCurrentChange:function(e){this.queryInfo.page=e,this.getArticlePage()},tableIndex:function(e){return(this.queryInfo.page-1)*this.queryInfo.size+e+1},refreshArticlePage:function(){this.getArticlePage(),this.editVisible=!1},handleDetails:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function a(){var n,l,r,i;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.row,t.detailsVisible=!0,t.detailsfileType=n.type,a.next=5,Object(c["c"])(n.id);case 5:l=a.sent,r=l.data,1==n.type?(i=r.articleUrl[0],t.player&&t.previewVideoUrl!==i.url&&(t.player.video.src=i.url),t.previewVideoUrl=i.url):2==n.type||n.type;case 8:case"end":return a.stop()}}),a)})))()},setPlayer:function(e){this.player=e},closeDetailsModal:function(){this.player&&this.player.pause()},handleEdit:function(e){var t=e.row;this.editVisible=!0,1==t.type?this.currentComponent=u["a"]:2==t.type?this.currentComponent=p["a"]:3==t.type&&(this.currentComponent=d["a"]),this.dataProp=t.id},handleEditState:function(e){var t=this;return Object(i["a"])(Object(s["a"])().mark((function a(){var n;return Object(s["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.row,a.next=3,Object(c["b"])(n.id).then((function(e){200===e.code?(t.getArticlePage(),t.$message.success("修改成功")):t.$message.error("修改失败")}));case 3:case"end":return a.stop()}}),a)})))()},handleDelete:function(e){var t=this,a=e.row;this.$confirm("确定要删除帖子吗？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(i["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["e"])(a.id).then((function(e){200===e.code?(t.getArticlePage(),t.$message.success("删除成功")):t.$message.error("删除失败，请检查后重试")}));case 2:case"end":return e.stop()}}),e)}))))}}},y=f,g=(a("0a09"),a("2877")),h=Object(g["a"])(y,n,l,!1,null,"9be11c84",null);t["default"]=h.exports}}]);