(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-28acdaec"],{"01c3":function(e,t,a){},"0a09":function(e,t,a){"use strict";a("6843")},"4a0d":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"})},r=[],i={name:"ArticleAudio",data:function(){return{}},created:function(){},methods:{}},o=i,l=a("2877"),s=Object(l["a"])(o,n,r,!1,null,"54b1c4d2",null);t["a"]=s.exports},6843:function(e,t,a){},"71c3":function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-form",{ref:"confirmVideoRef",staticStyle:{width:"80%","margin-top":"30px"},attrs:{model:e.videoInfo,"label-width":"50px","label-position":"right",rules:e.saveRules}},[a("el-form-item",{attrs:{label:"视频",prop:"otherFile"}},[a("el-upload",{ref:"upload",staticClass:"video-upload",attrs:{action:e.uploadAction,"before-upload":e.submitUpload,accept:".mp4,.avi"}},[e.videoExist?a("div",{staticClass:"addVideo"},[e._v(e._s(e.videoFileInfo.relName)+" "),a("i",{staticClass:"el-icon-refresh-left"}),e._v(" "+e._s(e.getFileSize(e.videoFileInfo.fileSize)))]):a("el-button",{staticClass:"addVideo",attrs:{type:"primary"}},[e._v("+ 添加视频")])],1)],1),a("el-form-item",{attrs:{label:"封面",prop:"cover"}},[a("el-upload",{staticClass:"cover-uploader",attrs:{action:e.uploadAction,"show-file-list":!1,"before-upload":e.beforeCoverUpload}},[e.videoInfo.cover?a("img",{staticClass:"cover",attrs:{src:e.coverUrl}}):a("i",{staticClass:"el-icon-plus cover-uploader-icon cover"})])],1),a("el-form-item",{attrs:{label:"标题",prop:"title"}},[a("el-input",{attrs:{placeholder:"请输入标题",maxlength:"80","show-word-limit":""},model:{value:e.videoInfo.title,callback:function(t){e.$set(e.videoInfo,"title",t)},expression:"videoInfo.title"}})],1),a("el-form-item",{attrs:{label:"分类",prop:"categoryId"}},[a("div",{staticClass:"block"},[a("el-cascader",{attrs:{options:e.options,props:{value:"id",label:"title"}},on:{change:e.handleChange},model:{value:e.videoInfo.categoryId,callback:function(t){e.$set(e.videoInfo,"categoryId",t)},expression:"videoInfo.categoryId"}})],1)]),a("el-form-item",{attrs:{label:"简介",prop:"profile"}},[a("el-input",{attrs:{placeholder:"填写更多相关信息",maxlength:"255","show-word-limit":""},model:{value:e.videoInfo.profile,callback:function(t){e.$set(e.videoInfo,"profile",t)},expression:"videoInfo.profile"}})],1),a("el-button",{staticClass:"save",on:{click:e.saveArticleDraft}},[e._v("存草稿")]),a("el-button",{staticClass:"save",attrs:{type:"primary"},on:{click:e.saveArticle}},[e._v("发布")])],1)],1)},r=[],i=a("c7eb"),o=a("1da1"),l=(a("b680"),a("b0c0"),a("75cc")),s=a("789c"),c=a("f974"),u={name:"ArticleVideo",props:["dataProp"],data:function(){return{loading:!1,articleFileId:null,videoInfo:{id:"",cover:"",title:"",categoryId:"",profile:"",type:"1",draft:!1,otherFile:[]},videoFileInfo:{},videoExist:!1,coverUrl:"",categoryList:{title:null,parents:!1},options:[],saveRules:{otherFile:[{required:!0,message:" ",trigger:"blur"}],cover:[{required:!0,message:" ",trigger:"blur"}],title:[{required:!0,message:" ",trigger:"blur"},{max:80,message:" ",trigger:"change"}],categoryId:[{required:!0,message:" ",trigger:"blur"}]}}},computed:{uploadAction:function(){return"javascript:void(0)"}},created:function(){this.getCategoryList(),this.getVideoInfo()},methods:{getCategoryList:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(l["b"])(e.categoryList);case 2:a=t.sent,e.options=a.data;case 4:case"end":return t.stop()}}),t)})))()},handleChange:function(e){var t=e[e.length-1];this.videoInfo.categoryId=t},getVideoInfo:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a,n;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(null==e.dataProp){t.next=11;break}return t.next=3,Object(c["c"])(e.dataProp);case 3:a=t.sent,n=a.data,e.videoInfo=n,e.videoInfo.otherFile=n.articleUrl,e.coverUrl=n.coverUrl,e.videoFileInfo=n.articleUrl[0],e.videoExist=!0,e.articleFileId=e.dataProp;case 11:case"end":return t.stop()}}),t)})))()},getFileSize:function(e){var t=(e/1048576).toFixed(2);return t>1024?t=t/1024+" GB":t<.9?t=1024*t+" KB":t+=" MB",t},submitUpload:function(e){var t=this,a=this.getFileType(e);if(a){this.loading=!0;var n=new FormData;n.append("file",e),n.append("type",a),Object(s["f"])(n).then((function(e){200===e.code?(t.videoFileInfo=e.data,t.videoInfo.otherFile=[{id:e.data.id,orderNum:1}],t.videoInfo.cover=e.data.id,t.coverUrl=e.data.thumbnailUrl,t.videoExist=!0,t.loading=!1,t.$message.success("上传成功")):(t.videoExist=!1,t.loading=!1,t.$message.error("上传失败"))}))}return!1},getFileType:function(e){var t="video/mp4"===e.type||"video/adv"===e.type;if(t)return 2;t||this.$message.error(e.name+"上传文件格式不支持！")},beforeCoverUpload:function(e){var t=this,a="image/jpeg"===e.type||"image/png"===e.type||"image/jpg"===e.type||"image/gif"===e.type,n=e.size/1024/1024<50;if(a||this.$message.error("上传图片只能是jpg、gif、png、jpeg格式!"),n||this.$message.error("上传图片大小不能超过 50MB!"),a&&n){var r=1,i=new FormData;i.append("file",e),i.append("type",r),Object(s["f"])(i).then((function(e){200===e.code?(t.$message.success("上传成功"),t.videoInfo.cover=e.data.id,t.coverUrl=e.data.url):t.$message.error("上传失败")}))}return!1},saveArticleDraft:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(e.videoExist){t.next=3;break}return e.$message.error("请先上传视频"),t.abrupt("return");case 3:e.videoInfo.draft=!0,e.saveOrEditVideoInfo();case 5:case"end":return t.stop()}}),t)})))()},saveOrEditVideoInfo:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=""!==e.videoInfo.id,a?Object(c["a"])(e.videoInfo,e.videoInfo.id).then((function(t){200===t.code?(0==e.videoInfo.draft?e.$message.success("发布成功"):e.$message.success("修改成功"),e.$emit("notifyParent")):e.$message.error("修改失败，请检查后重试")})):Object(c["f"])(e.videoInfo).then((function(t){200===t.code?(0==e.videoInfo.draft?e.$message.success("发布成功"):e.$message.success("保存成功"),e.$emit("notifyParent")):e.$message.error("添加用户失败，请检查后重试")}));case 2:case"end":return t.stop()}}),t)})))()},saveArticle:function(){var e=this;return Object(o["a"])(Object(i["a"])().mark((function t(){return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:e.$refs.confirmVideoRef.validate((function(t){t?(e.videoInfo.draft=!1,e.saveOrEditVideoInfo()):e.$message.error("请填写完整信息后提交")}));case 1:case"end":return t.stop()}}),t)})))()}}},d=u,f=(a("7af1"),a("2877")),p=Object(f["a"])(d,n,r,!1,null,"ebbde3ba",null);t["a"]=p.exports},"75cc":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return i})),a.d(t,"a",(function(){return o})),a.d(t,"c",(function(){return l}));var n=a("b775");function r(e){return Object(n["a"])({url:"/dynamicCategory/list",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/dynamicCategory/save",method:"post",data:e})}function o(e,t){return Object(n["a"])({url:"/dynamicCategory/edit/".concat(t),method:"put",data:e})}function l(e){return Object(n["a"])({url:"/dynamicCategory/remove/".concat(e),method:"delete"})}},"789c":function(e,t,a){"use strict";a.d(t,"f",(function(){return r})),a.d(t,"a",(function(){return i})),a.d(t,"c",(function(){return o})),a.d(t,"b",(function(){return l})),a.d(t,"e",(function(){return s})),a.d(t,"d",(function(){return c}));var n=a("b775");function r(e){return Object(n["a"])({url:"/file/upload",method:"post",data:e,headers:{"Content-Type":"multipart/form-data"}})}function i(e){return Object(n["a"])({url:"/file/download/".concat(e),method:"get"})}function o(e){return Object(n["a"])({url:"/file/page",method:"post",data:e})}function l(e){return Object(n["a"])({url:"/file/edit/state",method:"put",data:e})}function s(e){return Object(n["a"])({url:"/file/remove/".concat(e),method:"delete"})}function c(e){return Object(n["a"])({url:"/file/remove/batch",method:"delete",data:e})}},"7af1":function(e,t,a){"use strict";a("01c3")},a9e2:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"用户名搜索",clearable:""},on:{clear:e.getArticlePage},model:{value:e.queryInfo.nickname,callback:function(t){e.$set(e.queryInfo,"nickname",t)},expression:"queryInfo.nickname"}})],1),a("el-col",{attrs:{span:3}},[a("el-input",{attrs:{placeholder:"标题搜索",clearable:""},on:{clear:e.getArticlePage},model:{value:e.queryInfo.title,callback:function(t){e.$set(e.queryInfo,"title",t)},expression:"queryInfo.title"}})],1),a("el-col",{attrs:{span:3}},[a("el-cascader",{attrs:{placeholder:"分类搜索",options:e.options,props:e.props,"collapse-tags":"",clearable:"","show-all-levels":!1},on:{clear:e.getArticlePage},model:{value:e.queryInfo.categoryIds,callback:function(t){e.$set(e.queryInfo,"categoryIds",t)},expression:"queryInfo.categoryIds"}})],1),a("el-col",{attrs:{span:3}},[a("el-select",{attrs:{placeholder:"状态搜索",clearable:""},on:{clear:e.getArticlePage},model:{value:e.queryInfo.state,callback:function(t){e.$set(e.queryInfo,"state",t)},expression:"queryInfo.state"}},e._l(e.states,(function(e){return a("el-option",{key:e.key,attrs:{label:e.display_name,value:e.key}})})),1)],1),a("el-col",{attrs:{span:2}},[a("el-button",{attrs:{type:"primary"},on:{click:e.getArticlePage}},[e._v("搜索")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticStyle:{width:"100%","margin-top":"30px"},attrs:{data:e.aticleList,border:""}},[a("el-table-column",{attrs:{align:"center",label:"编号",type:"index",index:e.tableIndex,width:"55px"}}),a("el-table-column",{attrs:{align:"center",label:"类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.fileTypes[t.row.type-1].display_name)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"分类"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.categoryTitle)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"标题",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.title)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"创建时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("parseTime")(t.row.createTime,"{y}-{m}-{d} {h}:{i}")))])]}}])}),a("el-table-column",{attrs:{align:"center",label:"收藏数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.collectNum)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"点赞数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.praiseNum)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"评论数"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(t.row.commentNum)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.states[t.row.state+1].display_name)+" ")]}}])}),a("el-table-column",{attrs:{align:"center",label:"操作",width:"300px"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{directives:[{name:"show",rawName:"v-show",value:1==t.row.state,expression:"scope.row.state == 1"}],attrs:{type:"warning",size:"small"},on:{click:function(a){return e.handleEditState(t)}}},[e._v("屏蔽")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:3==t.row.state,expression:"scope.row.state == 3"}],attrs:{type:"info",size:"small"},on:{click:function(a){return e.handleEditState(t)}}},[e._v("取消屏蔽")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1!=t.row.state,expression:"scope.row.state != -1"}],attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleDetails(t)}}},[e._v(" "+e._s(e.$t("common.details"))+" ")]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:-1==t.row.state,expression:"scope.row.state == -1"}],attrs:{type:"primary",size:"small"},on:{click:function(a){return e.handleEdit(t)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(a){return e.handleDelete(t)}}},[e._v(" "+e._s(e.$t("common.delete"))+" ")])]}}])})],1),a("el-pagination",{attrs:{"current-page":e.queryInfo.page,"page-sizes":[10,20,50,100],"page-size":e.queryInfo.size,layout:"total, sizes, prev, pager, next, jumper",total:e.pageInfo.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}}),a("el-dialog",{attrs:{visible:e.detailsVisible,top:"10vh"},on:{"update:visible":function(t){e.detailsVisible=t},close:e.closeDetailsModal}},[1==e.detailsfileType?a("div",{staticClass:"video-modal-content"},[a("NPlayer",{ref:"player",attrs:{options:{src:e.previewVideoUrl,contextMenus:["loop","pip"],volumeVertical:!0,volumeProgressBg:"skyblue"},set:e.setPlayer}})],1):e._e()]),a("el-dialog",{attrs:{visible:e.editVisible,top:"10vh"},on:{"update:visible":function(t){e.editVisible=t}}},[a(e.currentComponent,{key:e.dataProp,tag:"component",attrs:{dataProp:e.dataProp},on:{notifyParent:e.refreshArticlePage}})],1)],1)},r=[],i=a("2909"),o=a("c7eb"),l=a("1da1"),s=(a("99af"),a("75cc")),c=a("f974"),u=a("71c3"),d=a("d9f5"),f=a("4a0d"),p={name:"Article",components:{articleVideo:u["a"],articleColumn:d["a"],articleAudio:f["a"]},data:function(){return{loading:!1,aticleList:[],pageInfo:{page:1,size:10,total:0,pages:0},queryInfo:{nickname:null,categoryIds:null,title:null,state:null,page:1,size:10},state:"",props:{multiple:!0,value:"id",label:"title"},categoryList:{title:null,parents:!1},options:[],fileTypes:[{key:"1",display_name:"视频"},{key:"2",display_name:"专栏"},{key:"3",display_name:"音频"}],states:[{key:"-1",display_name:"草稿"},{key:"0",display_name:"待审核"},{key:"1",display_name:"审核通过"},{key:"2",display_name:"审核未通过"},{key:"3",display_name:"屏蔽"}],detailsVisible:!1,detailsfileType:null,previewVideoUrl:null,player:null,editVisible:!1,currentComponent:null,dataProp:null}},created:function(){this.getCategoryList(),this.getArticlePage()},methods:{getCategoryList:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(s["b"])(e.categoryList);case 2:a=t.sent,e.options=a.data;case 4:case"end":return t.stop()}}),t)})))()},getCategoryIdList:function(){if(null!=this.queryInfo.categoryIds&&this.queryInfo.categoryIds.length>0){var e,t=(e=[]).concat.apply(e,Object(i["a"])(this.queryInfo.categoryIds));this.queryInfo.categoryIds=t}},getArticlePage:function(){var e=this;return Object(l["a"])(Object(o["a"])().mark((function t(){var a;return Object(o["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,e.getCategoryIdList(),t.next=4,Object(c["d"])(e.queryInfo);case 4:a=t.sent,e.aticleList=a.data.list,e.pageInfo=a.data.pageInfo,e.loading=!1;case 8:case"end":return t.stop()}}),t)})))()},handleSizeChange:function(e){this.queryInfo.size=e,this.getArticlePage()},handleCurrentChange:function(e){this.queryInfo.page=e,this.getArticlePage()},tableIndex:function(e){return(this.queryInfo.page-1)*this.queryInfo.size+e+1},refreshArticlePage:function(){this.getArticlePage(),this.editVisible=!1},handleDetails:function(e){var t=this;return Object(l["a"])(Object(o["a"])().mark((function a(){var n,r,i,l;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.row,t.detailsVisible=!0,t.detailsfileType=n.type,a.next=5,Object(c["c"])(n.id);case 5:r=a.sent,i=r.data,1==n.type?(l=i.articleUrl[0],t.player&&t.previewVideoUrl!==l.url&&(t.player.video.src=l.url),t.previewVideoUrl=l.url):2==n.type||n.type;case 8:case"end":return a.stop()}}),a)})))()},setPlayer:function(e){this.player=e},closeDetailsModal:function(){this.player&&this.player.pause()},handleEdit:function(e){var t=e.row;this.editVisible=!0,1==t.type?this.currentComponent=u["a"]:2==t.type?this.currentComponent=d["a"]:3==t.type&&(this.currentComponent=f["a"]),this.dataProp=t.id},handleEditState:function(e){var t=this;return Object(l["a"])(Object(o["a"])().mark((function a(){var n;return Object(o["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return n=e.row,a.next=3,Object(c["b"])(n.id).then((function(e){200===e.code?(t.getArticlePage(),t.$message.success("修改成功")):t.$message.error("修改失败")}));case 3:case"end":return a.stop()}}),a)})))()},handleDelete:function(e){var t=this,a=e.row;this.$confirm("确定要删除帖子吗？","Warning",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(Object(l["a"])(Object(o["a"])().mark((function e(){return Object(o["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(c["e"])(a.id).then((function(e){200===e.code?(t.getArticlePage(),t.$message.success("删除成功")):t.$message.error("删除失败，请检查后重试")}));case 2:case"end":return e.stop()}}),e)}))))}}},m=p,v=(a("0a09"),a("2877")),g=Object(v["a"])(m,n,r,!1,null,"9be11c84",null);t["default"]=g.exports},d9f5:function(e,t,a){"use strict";var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"})},r=[],i={name:"ArticleColumn",data:function(){return{}},created:function(){},methods:{}},o=i,l=a("2877"),s=Object(l["a"])(o,n,r,!1,null,"f8d5f79c",null);t["a"]=s.exports},f974:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"c",(function(){return i})),a.d(t,"f",(function(){return o})),a.d(t,"a",(function(){return l})),a.d(t,"b",(function(){return s})),a.d(t,"e",(function(){return c}));var n=a("b775");function r(e){return Object(n["a"])({url:"/dynamicArticle/page",method:"post",data:e})}function i(e){return Object(n["a"])({url:"/dynamicArticle/detail/".concat(e),method:"get"})}function o(e){return Object(n["a"])({url:"/dynamicArticle/save",method:"post",data:e})}function l(e,t){return Object(n["a"])({url:"/dynamicArticle/edit/".concat(t),method:"put",data:e})}function s(e){return Object(n["a"])({url:"/dynamicArticle/edit/state/".concat(e),method:"put"})}function c(e){return Object(n["a"])({url:"/dynamicArticle/remove/".concat(e),method:"delete"})}}}]);